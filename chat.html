<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ChatGPT-Style Interface</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/styles/theme.css" />
    <link rel="stylesheet" href="src/styles/sidebar.css" />
    <link rel="stylesheet" href="src/styles/components/inputs.css" />
    <link rel="stylesheet" href="src/styles/components/modals.css" />
  </head>
  <body class="has-navbar-fixed-top">
    <!-- Top Navigation -->
    <nav class="navbar is-link is-fixed-top" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a class="navbar-item" href="#">
          <strong>Chat Interface</strong>
        </a>
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="sidebarMenu">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu">
        <div class="navbar-end">
          <div class="navbar-item">
            <button id="settings-btn" class="button is-light">
              <span class="icon"><i class="fas fa-cog"></i></span>
              <span>Settings</span>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <div class="columns is-gapless is-mobile" style="height: calc(100vh - 52px); overflow: hidden;">
      <!-- Sidebar -->
      <aside class="column is-2 is-hidden-mobile sidebar" id="sidebarMenu" style="height: 100%; overflow-y: auto;">
        <div class="menu-container">
          <ul class="menu-list" id="chat-list"></ul> 
          <div class="menu-actions">
            <a id="new-chat-btn" class="button is-fullwidth is-link">
              <span class="icon"><i class="fas fa-plus"></i></span>
              <span>New chat</span>
            </a>
          </div>
        </div>
      </aside>

      <!-- Main Chat Area -->
      <main class="column is-12-mobile is-10-desktop section" style="height: 100%; overflow: hidden;">
        <div class="container is-fluid" style="height: 100%; display: flex; flex-direction: column; align-items: center;">
          <!-- Centered Container for Chat Content -->
          <div class="container is-fluid" style="flex: 1; display: flex; flex-direction: column; height: 100%;">
          <div id="chat-history" class="box content" style="overflow-y: auto;"></div>
          <div class="field has-addons mt-4">
            <!-- Model Selector -->
            <div class="control">
              <div class="select">
                <select id="model-select"></select>
              </div>
            </div>
            <!-- Instruction Selector -->
            <div class="control" id="instructions-group" style="display: none;">
              <div class="select">
                <select id="instructions-select"></select>
              </div>
              <button id="edit-instruction-btn" class="button is-small" style="display: none;">
                Edit
              </button>
            </div>
            <!-- User Input -->
            <div class="control is-expanded">
              <textarea
                id="user-input"
                class="textarea"
                placeholder="Type your message..."
                rows="1"
              ></textarea>
            </div>
            <!-- Send Button -->
            <div class="control">
              <button id="send-btn" class="button is-primary">
                <span class="icon"><i class="fas fa-paper-plane"></i></span>
              </button>
          </div>
        </div>
      </div>
      </main>
    </div>


    <!-- Custom Modal -->
    <div id="custom-modal" class="modal">
      <div class="modal-background"></div>
      <div class="modal-card">
        <header class="modal-card-head">
          <p class="modal-card-title" id="custom-modal-title">Title</p>
          <button id="custom-modal-close" class="delete" aria-label="close"></button>
        </header>
        <section class="modal-card-body" id="custom-modal-body">
          <!-- Message content will be injected here -->
        </section>
        <footer class="modal-card-foot" id="custom-modal-footer">
          <!-- Buttons will be injected here -->
        </footer>
      </div>
    </div>

    <!-- Include Marked.js and DOMPurify via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.7/dist/purify.min.js"></script>

    <!-- Include Instructions -->
    <script src="src/instructions.js"></script>

    <!-- Application Modules -->
    <script src="src/models.js"></script>
    <script src="src/storage.js"></script>
    <script src="src/config.js"></script>
    <script src="src/api.js"></script>
    <script src="src/chat.js"></script>
    <script src="src/message.js"></script>
    <script src="src/rendering.js"></script>
    <script src="src/events.js"></script>
    <script src="src/modal.js"></script>
    <script src="src/controller.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        ControllerModule.initializeApp();
      });
    </script>
  </body>
</html>
